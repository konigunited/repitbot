# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "There is no text in the message to edit"

## üîß –ü—Ä–æ–±–ª–µ–º–∞:
–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å —Ñ–æ—Ç–æ-—Å–æ–æ–±—â–µ–Ω–∏–µ, –∞ –∑–∞—Ç–µ–º –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥ –∫ —Ä–µ–±–µ–Ω–∫—É" —Å–∏—Å—Ç–µ–º–∞ –ø—ã—Ç–∞–ª–∞—Å—å –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ —Ñ–æ—Ç–æ-—Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ —Ç–µ–∫—Å—Ç, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫—É.

## üí° –†–µ—à–µ–Ω–∏–µ:
–°–æ–∑–¥–∞–Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `safe_edit_or_reply()` –∫–æ—Ç–æ—Ä–∞—è:

1. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è** - –µ—Å—Ç—å –ª–∏ –≤ –Ω–µ–º —Ç–µ–∫—Å—Ç
2. **–ï—Å–ª–∏ —Ç–µ–∫—Å—Ç –µ—Å—Ç—å** - —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–±—ã—á–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º  
3. **–ï—Å–ª–∏ —Ç–µ–∫—Å—Ç–∞ –Ω–µ—Ç** (—Ñ–æ—Ç–æ, –¥–æ–∫—É–º–µ–Ω—Ç –∏ —Ç.–¥.) - —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ
4. **–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –º–µ—Ç–æ–¥—ã –æ—Ç–ø—Ä–∞–≤–∫–∏

## üîß –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

### 1. **–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `safe_edit_or_reply()`**
```python
async def safe_edit_or_reply(update, text, reply_markup=None, parse_mode=None):
    """–ë–µ–∑–æ–ø–∞—Å–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ"""
    try:
        if update.callback_query.message.text:
            await update.callback_query.edit_message_text(...)
        else:
            # –£–¥–∞–ª—è–µ–º —Ñ–æ—Ç–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            await update.callback_query.message.delete()
            await update.callback_query.message.reply_text(...)
    except Exception as e:
        # Fallback –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
        ...
```

### 2. **–ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `edit_message_text()` –Ω–∞ `safe_edit_or_reply()`**
- ‚úÖ `show_child_menu()` - –º–µ–Ω—é —Ä–µ–±–µ–Ω–∫–∞
- ‚úÖ `show_child_progress()` - –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ–±–µ–Ω–∫–∞  
- ‚úÖ `parent_generate_chart()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

### –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
```
Test 1: Message with text
  edit_message_text: Test message with text...

Test 2: Message without text (photo)  
  message deleted
  reply_text: Test message after photo...

SUCCESS: safe_edit_or_reply works correctly
```

### –¢–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –≥—Ä–∞—Ñ–∏–∫–∞:
```
Simulating navigation from photo message to child menu...
  photo message deleted
  new message sent: **–í–∞–Ω—è –ò–≤–∞–Ω–æ–≤–∏—á**...
  callback answered

SUCCESS: Navigation after chart works
```

## üéØ **–°–¢–ê–¢–£–°: –ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–û!**

### ‚úÖ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ñ–æ—Ç–æ —Å –≥—Ä–∞—Ñ–∏–∫–æ–º
2. **–ù–∞–≤–∏–≥–∞—Ü–∏—è –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞** - –∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥ –∫ —Ä–µ–±–µ–Ω–∫—É" –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã –ø—Ä–∏ —Å–±–æ—è—Ö

### üöÄ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–æ–ª—å—à–µ –Ω–µ —É–≤–∏–¥—è—Ç –æ—à–∏–±–∫—É:
‚ùå `"There is no text in the message to edit"`

–í—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑—É–ø—Ä–µ—á–Ω–æ!